# Dynamic Markdown Display Feature

## Overview

This feature dynamically displays the content of `.md` files generated in the marketing_ai `output` folder within the Workflow Results section on the frontend. The implementation prioritizes real content from the markdown files, providing real-time updates during workflow execution.

## How It Works

1. **API Endpoints**:
   - `/api/markdown` - Fetches and processes markdown files from the output directory for a specific agent
   - `/api/marketing` - Handles workflow execution by scanning for existing markdown files in the output directory

2. **Real-time Updates**:
   - During workflow execution, the frontend polls for newly generated markdown files every 3 seconds
   - When a file is found, the UI automatically updates to display the markdown content
   - A notification informs the user when new content is available
   - Polling continues until all agents have either completed or encountered errors

3. **Visual Indicators**:
   - A "From File" badge appears when displaying content from an actual markdown file
   - Processing status indicators show which agents are actively running
   - Tabs organize outputs for each agent in the workflow
   - Error states provide useful information when files cannot be found or read

## Implementation Details

### Backend Components

- **Markdown API (`/api/markdown/route.ts`)**:
  - Maps agent IDs to corresponding markdown filenames
  - Reads and processes files from the marketing_ai output directory
  - Ensures proper markdown formatting with consistent headings and newlines
  - Returns formatted content for display in the frontend

- **Marketing API (`/api/marketing/route.ts`)**:
  - Checks for existing markdown files in the output directory
  - Returns content only from actual files, without simulated content
  - Sets appropriate status flags to indicate processing state when files don't exist yet
  - Creates the output directory if it doesn't exist

### Frontend Components

- **Polling Mechanism (`Playground.tsx`)**:
  - Checks for new markdown files every 3 seconds during workflow execution
  - Updates UI in real-time when new files are detected
  - Handles errors gracefully if files are not found
  - Provides visual feedback on the current state of each agent

- **User Interface Enhancements**:
  - Source indicators show that content comes from an actual file
  - Special formatting for file-based content to distinguish it visually
  - Improved error handling with clear messages and recovery options
  - Status indicators show which agents are currently processing

## Location of Generated Markdown Files

The markdown files are generated by the marketing_ai backend and stored in:
```
/marketing_ai/marketing_ai/output/
```

Each agent has its own corresponding markdown file:
- `competitor_analysis.md`
- `product_recommendations.md`
- `trend_identification.md`
- `content_creation.md`
- `sales_enablement.md`

## Usage

1. Configure and launch a marketing workflow through the UI
2. The system will check for markdown files in the output directory
3. If files exist, they'll be displayed with a "From File" indicator
4. If files don't exist yet, agents will remain in "Processing" state
5. As new files are generated during execution, the UI will update automatically
6. You can use the provided `scripts/create-sample-markdown.js` to generate sample files for testing

## Testing with Sample Files

To test the feature with sample markdown files:

1. Run the sample file generation script:
   ```
   node scripts/create-sample-markdown.js
   ```
2. This will create professionally formatted markdown files in the output directory
3. Launch the workflow in the UI to see these files displayed

## Future Enhancements

Potential improvements for future iterations:

1. **File History**: Add ability to view previous versions of generated markdown files
2. **Download Option**: Allow users to download markdown files directly from the UI
3. **Diff View**: Show differences between multiple runs of the same workflow
4. **Custom Output Directory**: Allow users to specify where markdown files are stored
5. **Real-time Streaming**: Implement server-sent events or WebSockets for real-time updates 